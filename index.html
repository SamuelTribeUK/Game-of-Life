<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Three.js</title>
	<link rel="stylesheet" href="main.css">
	<script src="libs/three.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/gsap.min.js"></script>

</head>
<body>

<script>

	let scene = new THREE.Scene();

	let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
	camera.position.z = 5;

	let renderer = new THREE.WebGLRenderer({antialias: true});
	renderer.setClearColor("#ffffff");
	renderer.setSize(window.innerWidth, window.innerHeight);

	document.body.appendChild(renderer.domElement);

	window.addEventListener("resize", () => {
		renderer.setSize(window.innerWidth, window.innerHeight);
		camera.aspect = window.innerWidth / window.innerHeight;

		camera.updateProjectionMatrix();
	})

	let rayCaster = new THREE.Raycaster();
	let mouse = new THREE.Vector2();

	window.addEventListener("keypress", () => {
		console.log("keypress!");
		let key = String.fromCharCode(event.which);

		switch (key) {
			case "a":
				camera.position.x -= 1;
				break;
			case "d":
				camera.position.x += 1;
				break;
			case "w":
				camera.position.z -= 1;
				break;
			case "s":
				camera.position.z += 1;
				break;
			case "r":
				camera.position.y += 1;
				break;
			case "f":
				camera.position.y -= 1;
				break;
		}
	});

	let boxes = [];

	for (let i = -5; i < 5; i++) {
		let geometry = new THREE.BoxGeometry(0.8, 0.8, 0.8);
		let material = new THREE.MeshLambertMaterial({color: "#" + ('00000'+(Math.random()*(1<<24)|0).toString(16)).slice(-6)});
		let mesh = new THREE.Mesh(geometry, material);

		mesh.position.set(i, 0, -2);

		boxes[i + 5] = mesh;

		scene.add(boxes[i + 5]);
	}

	let light = new THREE.PointLight(0xFFFFFF, 1, 500);
	light.position.set(10, 25, 25);
	scene.add(light);
	light.position.set(-10, 25, 25);
	scene.add(light);

	let render = function() {
		requestAnimationFrame(render);
		renderer.render(scene, camera);
	}

	function randomMove() {
		for (let i = 0; i < 10; i++) {
			this.tl = new TimelineMax();
			this.tl.to(boxes[i].position, {duration: 1, x: Math.random() * 2, y: Math.random() * 2, z: Math.random() * 2, ease: Expo.easeOut});
		}
	}

	// function onMouseMove(event) {
	// 	event.preventDefault();
	//
	// 	mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
	// 	mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
	//
	// 	rayCaster.setFromCamera(mouse, camera);
	//
	// 	let intersects = rayCaster.intersectObjects(scene.children, true);
	//
	// 	for (let i = 0; i < intersects.length; i++) {
	// 		this.tl = new TimelineMax();
	// 		this.tl.to(intersects[i].object.scale, {duration: 1, x: 2, ease: Expo.easeOut});
	// 		this.tl.to(intersects[i].object.scale, {duration: .5, x: .5, ease: Expo.easeOut});
	// 		this.tl.to(intersects[i].object.position, {duration: .5, x: -5, ease: Expo.easeOut});
	// 		this.tl.to(intersects[i].object.rotation, {duration: .5, y: Math.PI*.5, ease: Expo.easeOut}, "=-1.5");
	// 	}
	// }

	// window.addEventListener("click", onMouseMove);

	setInterval(randomMove, 1000);

	render();

</script>
</body>
</html>